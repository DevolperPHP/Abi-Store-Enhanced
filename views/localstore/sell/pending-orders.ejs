<%- include("../layout/navbar") -%>

<div class="cashier-content">
    <!-- Page Header -->
    <div class="page-header">
        <h1 class="page-title">Pending Orders</h1>
        <p class="page-subtitle">Recall or delete orders that are on hold</p>
    </div>

    <div class="modern-card">
        <div class="modern-card-header">
            <div>
                <h3 class="modern-card-title">Held Orders</h3>
                <p class="modern-card-subtitle"><%= orders.length %> order(s) on hold</p>
            </div>
             <a href="/localstore/sell" class="btn btn-primary">
                <ion-icon name="arrow-back-outline"></ion-icon>
                Back to POS
            </a>
        </div>

        <% if(orders.length > 0) { %>
            <div style="overflow-x: auto;">
                <table class="modern-table">
                    <thead>
                        <tr>
                            <th>Order ID</th>
                            <th>Date</th>
                            <th>Cashier</th>
                            <th>Items</th>
                            <th>Total</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% for (let order of orders) { %>
                            <tr>
                                <td><strong>#<%= order.bid %></strong></td>
                                <td><%= order.Date %></td>
                                <td><%= order.name %></td>
                                <td><%= order.products.reduce((sum, item) => sum + item.qty, 0) %></td>
                                <td><%= order.total.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") %> IQD</td>
                                <td style="display: flex; gap: 8px;">
                                    <form action="/localstore/sell/recall/<%= order._id %>" method="POST" style="margin: 0;">
                                        <button type="submit" class="btn btn-success btn-icon" title="Recall Order">
                                            <ion-icon name="play-back-outline"></ion-icon>
                                        </button>
                                    </form>
                                    <form action="/localstore/sell/pending/<%= order._id %>?_method=DELETE" method="POST" style="margin: 0;" onsubmit="return confirm('Are you sure you want to delete this pending order?');">
                                        <button type="submit" class="btn btn-danger btn-icon" title="Delete Order">
                                            <ion-icon name="trash-outline"></ion-icon>
                                        </button>
                                    </form>
                                </td>
                            </tr>
                        <% } %>
                    </tbody>
                </table>
            </div>
        <% } else { %>
            <div style="text-align: center; padding: 48px 24px; color: var(--text-secondary);">
                <ion-icon name="pause-circle-outline" style="font-size: 64px; opacity: 0.3;"></ion-icon>
                <p style="margin-top: 16px; font-size: 16px;">No orders are currently on hold.</p>
            </div>
        <% } %>
    </div>
</div>

<%- include("../layout/footer") -%>
